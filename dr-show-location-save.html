<!DOCTYPE html>
<html>
<head>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1">

<title>Geo App Show Location</title>

<meta name="viewport" content="width=device-width, initial-scale=1"> 

<link rel="stylesheet" href="inc/jq/themes/theme-02.min.css" />
<link rel="stylesheet" href="inc/jq/themes/jquery.mobile.icons.min.css" />

<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile.structure-1.4.5.min.css" />

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

<script>
	$(function(){
		$( "[data-role='header'], [data-role='footer']" ).toolbar();
		});
    </script>

<link href="mob.css" rel="stylesheet" type="text/css" />

  
</head>
<body onload="initialize()">


<div data-role="header" data-position="fixed" data-theme="a">

<div class="box1 center1 boxblue" >
<a href="index.html" rel="external"><img src="app-logo-banner-320x60.png" width="300" height="60" border="0"></a>
</div>
<!--add header -->
</div>

<!-- /header -->

<section id="page01111" data-role="page">

<div role="main" class="ui-content">
<div class="content" >
<div class="box1 center1" >
  
      
<!--INSERT START -->

<table width="99%" border="0" cellspacing="2" cellpadding="2">
<tr>
<td><a rel="external" href="dr-dashboard.html" class="buttonlink2 center1">Driver Home</a></td>
<td><a rel="external" href="dr-geo-list-mobile.html" class="buttonlink2 center1">Recent Locations</a></td>
<td><a rel="external" href="dr-geo-add-button.html" class="buttonlink2 center1">Try Again</a></td>
</tr>
</table>




<!--<p class="big24" id="actionchoice"></p> -->



<script language="javascript">         
         function checkBtn(event) {
localStorage.setItem("Action", event.target.name);

//rev don't have both choose not nowaction
localStorage.setItem("nowaction", event.target.name);

//document.getElementById("actionchoice").innerHTML = event.target.name;

// maybe put inside sendready

//alert("bubb");

$("#logthisnow").trigger('click');


if (localStorage.getItem("sendready") == "yes"){

	$("#show1").show(1000);
	}

         }
      </script>

LOG Action: <br>
<table  border="0" align="center" cellpadding="2" cellspacing="2">
<tr>
<td colspan="3">&nbsp;<a rel="external" href="dr-geo-add-button.html" class="buttonlink2 center1">UPDATE LOC</a>&nbsp;</td>
</tr>
<tr>
<td>

<input id="Arrive" type="button" class="buttonform2_24" name="Arrive" value= "&nbsp;&nbsp;&nbsp;&nbsp;Arrive&nbsp;&nbsp;&nbsp;&nbsp;<br><br><br>
" onClick="checkBtn(event)" />
</td>
<td>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</td>





<td>
<input id="Leave
" type="button" class="buttonform2_24" name="Leave" value= "&nbsp;&nbsp;&nbsp;&nbsp;Leave&nbsp;&nbsp;&nbsp;&nbsp;<br><br><br>" onClick="checkBtn(event)" />

</td>

</tr>
</table>


</td>
<td width="50%" align="left" valign="top">
Current Address (Accuracy: <strong><span id="nowaccuracy"></span></strong>):

<span class="fgreen">
<strong>
<div id = "address_current"></div>
</strong>


</span>

<!--ACTION: 
<strong>
<span class="fgreen" id="nowaction"></span></strong> -  -->


<br>





DATE: 
<strong>
<span id="nowgidts"></span></strong>


<!--<br>
<div id = "address_current2"></div> -->
</span>
<br>


<!--Lat: <div id = "nowlat"></div>
Lng: <div id = "nowlng"></div>


<br><br>

 -->
 
 <table border="0" align="center" cellpadding="2" cellspacing="2">
<tr>
<td>



<div align="center" style="height: 1px; width: 320px">

<!--<input id="latlng" type="text" value="34.16214883658795,-118.40303643729916">


id="PUC_Number" name="PUC_Number"
<span id = "nowlat1"></span>,
<span id = "nowlng1"></span>
 
 -->
</div>
<!--
 -->
 
 
 <div id="mappy">
 <div id="map" style="height: 200px; width: 320px"></div>
 </div>
 
 

<!--<div id="map" style="height: 0px; width: 0px"></div> -->
<br>



<div id="skippy">
<!--we can just hide this w jquery - but we still need the code in the script -->

<form id="locForm">
<input name="" type="text" id="latlng" >
<input id="sendit" type="button" value="Reverse Geocode" onclick="codeLatLng()">
</form>

</div>

</td>
</tr>
</table>
 

<br>
<!--


<br>
real lat long<br>
lat <span id="Latitude"></span> - 
lng <span id="Longitude"></span> - 
Accuracy <span id="Accuracy"></span> - 
ts <span id="Timestamp"></span> - 

now <span id="nowgeots"></span> - 


<br><br><br><br>


<span class="print_data_22_b">
Street Address Location API Test<br><br>





<strong>
<span id="nowconame"></span> </strong>(CID 
<span id="nowcid"></span> )
<br>


<strong>
<!--<span id="nowwrkname"></span>

<span id="first"></span> <span id="last"></span>

 
</strong>




(WID <span id="nowwid"></span>)  
<br> -->



<br>

<div id="tmp33">
<input id="logthisnow" type="button" class="ui-btn ui-btn-d tsize1" name="submit" value= " - LOG THIS LOCATION - " onClick="testResults(this.form)" />
</div>
<!-- -->

<!--INSERT END -->

</div><!-- end .box -->
</div><!-- end .content -->
</div><!-- /ui-content -->
  
</section><!-- /page -->
<!-- 
<footer data-role="footer" class="ui-barNAH" data-position="fixed" data-theme="a">
<div class="ui-grid-c boxblue">

</div>
</footer>

/footer -->

</body>
</html>

<!-- code for including header/footer -->
    <script type="text/javascript">
      
      // we're ready, include away
      $(window).ready(function(){
        
        // use easy AJAX jQuery helpers
        
		// header no work!!!!
        // add header.html into <header>
        $.get("header-inc.html", function(fileData){
          $('header').html(fileData); 
        });
 /*  
        // add footer.html into <footer>
        $.get("footer-inc.html", function(fileData){
          $('footer').html(fileData); 
        });
       
	 */
	   
	   
      });
      
    </script>
    
    

<script>
var geocoder;
var map;
var infowindow = new google.maps.InfoWindow();
var marker;
function initialize()
{

//alert("go1");

var nowlat = localStorage.getItem("nowlat");
var nowlng = localStorage.getItem("nowlng");

    geocoder = new google.maps.Geocoder();
    map = new google.maps.Map(document.getElementById("map"),
    {
        zoom: 14,
        center: new google.maps.LatLng(nowlat,nowlng),
        mapTypeId: google.maps.MapTypeId.ROADMAP
		
		//me
		//document.getElementById('address_current').textContent = results[0].formatted_address;
		
    });
	
	
// me2
//alert("go1");
//document.getElementById('locForm').submit();

$("#sendit").trigger('click');
	
}

function codeLatLng()
{
    var input = document.getElementById("latlng").value;
    var latlngStr = input.split(",",2);
    var lat = parseFloat(latlngStr[0]);
    var lng = parseFloat(latlngStr[1]);
    var latlng = new google.maps.LatLng(lat, lng);
    geocoder.geocode({'latLng': latlng}, function(results, status)
    {
        if (status == google.maps.GeocoderStatus.OK)
        {
            if (results[0])
            {
				
				//$('#address_current2').text(results[0].formatted_address);


// new save address		
				
localStorage.setItem("Address", results[0].formatted_address);
				
document.getElementById('address_current').textContent = results[0].formatted_address;
				
                map.setZoom(11);
                marker = new google.maps.Marker(
                {
                    position: latlng,
                    map: map
                });
                infowindow.setContent(results[0].formatted_address);
                infowindow.open(map, marker);
            }
            else
            {
                alert("No results found");
            }
        }
        else
        {
            alert("Geocoder failed due to: " + status);
        }
    });
}


// me

//document.getElementById('getlat').textContent = nowlat;
//document.getElementById('getlng').textContent = nowlng;
//document.getElementById('nowlat').textContent = localStorage.getItem("nowlat");
//document.getElementById('nowlng').textContent = localStorage.getItem("nowlng");
//document.getElementById('nowlat1').textContent = localStorage.getItem("nowlat");
//document.getElementById('nowlng1').textContent = localStorage.getItem("nowlng");


//pre populate

var a = document.getElementById("latlng");

// this for show page var latlngform = localStorage.getItem("nowlat") + "," + localStorage.getItem("nowlng")

var latlngform = localStorage.getItem("Latitude") + "," + localStorage.getItem("Longitude")
  a.value = latlngform;

//document.latlng.value=localStorage.getItem("nowlat");

document.getElementById('address_current').textContent = "Click to see..";

//$('#address_current').text('yo99');

</script>    


<script>


/*

document.getElementById('nowcid').textContent = localStorage.getItem("nowcid");
document.getElementById('nowconame').textContent = localStorage.getItem("nowconame");
document.getElementById('nowwid').textContent = localStorage.getItem("nowwid");


//document.getElementById('nowwrkname').textContent = localStorage.getItem("nowwrkname");

document.getElementById('first').textContent = localStorage.getItem("dr_first");
document.getElementById('last').textContent = localStorage.getItem("dr_last");
*/




//var gidts = new Date(Number(localStorage.getItem("nowgidts")));

//document.getElementById('nowgidts').textContent = gidts;


//document.getElementById('nowaccuracy').textContent = localStorage.getItem("nowaccuracy");
//document.getElementById('nowaction').textContent = localStorage.getItem("nowaction");

var gidts = new Date(Number(localStorage.getItem("Timestamp")));
document.getElementById('nowgidts').textContent = gidts;
document.getElementById('nowaccuracy').textContent = localStorage.getItem("Accuracy");
//document.getElementById('nowaction').textContent = localStorage.getItem("Action");



</script>




<script>
function testResults (form) {

// start post	
	
// show that something is loading
		$('#responsepost').html("<b>Loading response...</b>");
		
		/*
		 * 'post_receiver.php' - where you will pass the form data
		 * $(this).serialize() - to easily read form data
		 * function(data){... - data contains the response from post_receiver.php
		 */


//here new 

var getstuff = localStorage.getItem("Latitude") + " - " + localStorage.getItem("Longitude") + " - " + localStorage.getItem("Accuracy") + " - " + localStorage.getItem("Timestamp") + " - " + localStorage.getItem("nowgeots") + " - " + localStorage.getItem("Action");

//alert("getstuff  " + getstuff);
	 
//$.post('https://idcapp.com/app-data/client-update-number.php', {
	
//$.post('../app-data/geo-add.php', {
	// no ssl here
$.post('http://nmiapp.com/zgeo/app-data/geo-add.php', {
//$.post('zgeox.html', {

address: 	localStorage.getItem("Address"),
latitude: 	localStorage.getItem("Latitude"),
longitude: 	localStorage.getItem("Longitude"),
accuracy: 	localStorage.getItem("Accuracy"),
timestamp: 	localStorage.getItem("Timestamp"),
nowgeots: 	localStorage.getItem("nowgeots"),
action: 	localStorage.getItem("Action"),	
cid:		localStorage.getItem("nowcid"),	
wid:		localStorage.getItem("nowwid")

// there was cid and wid - maybe dump
	
}, function(data){
			
			// show the response
			$('#responsepost').html(data);
			//
			//alert( "Posting yo." + getstuff);
// no need
			
			//$('#response2').html(data);
			
			//dr-geo-list-mobile.html
		//window.location.replace("geo-list-wrk-mobile.html");
		// BACK SOON OR JUST STAY HERE window.location.replace("dr-geo-list-mobile.html");
		}).fail(function() {
		
			// just in case posting your form failed
			alert( "Posting failed." );
			
		});

		// to prevent refreshing the whole page page
		return false;


//window.location.replace("new-client-application-register3.html");
		
			
	
}
</script>








<script>




//document.getElementById('Latitude').textContent = localStorage.getItem("Latitude");
//document.getElementById('Longitude').textContent = localStorage.getItem("Longitude");
//document.getElementById('Altitude').textContent = Altitude;
//document.getElementById('Accuracy').textContent = localStorage.getItem("Accuracy");
//document.getElementById('Altitude_Accuracy').textContent = Altitude_Accuracy;
//document.getElementById('Heading').textContent = Heading;
//document.getElementById('Speed').textContent = Speed;
//document.getElementById('Timestamp').textContent = localStorage.getItem("Timestamp");
//document.getElementById('nowgeots').textContent = localStorage.getItem("nowgeots");



$("#tmp33").show(4000);
$("#tmp33").hide(4000);
	
$("#skippy").show(4000);
$("#skippy").hide(4000);

$("#mappy").show(4000);
$("#mappy").hide(4000);

</script>



